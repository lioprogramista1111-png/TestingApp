# Frontend Testing Documentation

## 🧪 Testing Framework

This Angular application uses **Jasmine** and **Karma** for unit and integration testing.

### Testing Stack
- **Jasmine**: Behavior-driven testing framework
- **Karma**: Test runner for executing tests in browsers
- **Angular Testing Utilities**: Angular-specific testing helpers
- **HttpClientTestingModule**: For mocking HTTP requests

## 📊 Test Coverage

**Current Coverage: 100%**
- **Statements**: 100% (29/29)
- **Branches**: 100% (1/1) 
- **Functions**: 100% (8/8)
- **Lines**: 100% (28/28)

## 🧩 Test Structure

### 1. Service Tests (`text-submission.service.spec.ts`)
Tests for the `TextSubmissionService`:
- ✅ Service creation
- ✅ HTTP POST requests (submitText)
- ✅ HTTP GET requests (getSubmissions)
- ✅ Error handling
- ✅ Request/response validation

### 2. Component Tests (`text-submission-form.component.spec.ts`)
Tests for the `TextSubmissionForm` component:
- ✅ Component creation
- ✅ Form initialization
- ✅ Form validation (required, maxlength)
- ✅ Error message display
- ✅ Character count display
- ✅ Submit button state
- ✅ Successful submission flow
- ✅ Error handling flow
- ✅ Loading states
- ✅ Form reset after submission

### 3. App Component Tests (`app.component.spec.ts`)
Tests for the main `App` component:
- ✅ Component creation
- ✅ Title property
- ✅ Template rendering
- ✅ Child component inclusion
- ✅ Router outlet presence

## 🚀 Running Tests

### Run All Tests
```bash
ng test
```

### Run Tests Once (CI Mode)
```bash
ng test --watch=false --browsers=ChromeHeadless
```

### Run Tests with Coverage
```bash
ng test --watch=false --browsers=ChromeHeadless --code-coverage
```

### Run Specific Test File
```bash
ng test --include="**/text-submission-form.component.spec.ts"
```

## 🔧 Test Configuration

### Karma Configuration
Located in `karma.conf.js` (auto-generated by Angular CLI)

### Test Setup
- **TestBed**: Angular testing utility for configuring test modules
- **Mocking**: Using Jasmine spies for service dependencies
- **HTTP Testing**: Using `HttpClientTestingModule` and `HttpTestingController`

## 📝 Test Examples

### Service Test Example
```typescript
it('should submit text successfully', () => {
  const mockRequest: TextSubmissionRequest = { text: 'Test submission' };
  const mockResponse: TextSubmissionModel = {
    id: 1,
    text: 'Test submission',
    createdAt: '2025-09-16T23:00:00.000Z'
  };

  service.submitText(mockRequest).subscribe(response => {
    expect(response).toEqual(mockResponse);
  });

  const req = httpMock.expectOne('https://localhost:7014/api/TextSubmission');
  expect(req.request.method).toBe('POST');
  req.flush(mockResponse);
});
```

### Component Test Example
```typescript
it('should validate required field', () => {
  const textControl = component.textForm.get('text');
  
  textControl?.setValue('');
  expect(textControl?.hasError('required')).toBeTruthy();
  
  textControl?.setValue('Some text');
  expect(textControl?.hasError('required')).toBeFalsy();
});
```

## 🎯 Testing Best Practices

### 1. **Arrange, Act, Assert (AAA) Pattern**
- **Arrange**: Set up test data and mocks
- **Act**: Execute the code under test
- **Assert**: Verify the expected outcome

### 2. **Test Isolation**
- Each test is independent
- Use `beforeEach` for common setup
- Clean up after tests with `afterEach`

### 3. **Descriptive Test Names**
- Use clear, descriptive test names
- Follow the pattern: "should [expected behavior] when [condition]"

### 4. **Mock External Dependencies**
- Mock HTTP services
- Mock complex dependencies
- Use Jasmine spies for method calls

### 5. **Test Edge Cases**
- Empty inputs
- Maximum length inputs
- Error scenarios
- Loading states

## 🔍 Test Categories

### Unit Tests
- Test individual components/services in isolation
- Mock all dependencies
- Fast execution
- High coverage

### Integration Tests
- Test component-service interactions
- Test form submission flow
- Test HTTP communication
- Verify data flow

## 📈 Continuous Integration

### GitHub Actions Example
```yaml
- name: Run Tests
  run: |
    cd frontend/text-submission-app
    npm ci
    ng test --watch=false --browsers=ChromeHeadless --code-coverage
```

### Test Reports
- Coverage reports generated in `coverage/` directory
- HTML reports available for detailed analysis
- CI/CD integration for automated testing

## 🛠️ Debugging Tests

### Common Issues
1. **Import Errors**: Ensure all required modules are imported in TestBed
2. **Async Issues**: Use `fakeAsync` and `tick()` for async operations
3. **DOM Issues**: Use `fixture.detectChanges()` to trigger change detection

### Debugging Tools
- Browser DevTools (when running with `--browsers=Chrome`)
- Console logging in tests
- Jasmine's `fdescribe` and `fit` for focused testing

## 📚 Additional Resources

- [Angular Testing Guide](https://angular.io/guide/testing)
- [Jasmine Documentation](https://jasmine.github.io/)
- [Karma Documentation](https://karma-runner.github.io/)
- [Angular Testing Utilities](https://angular.io/guide/testing-utility-apis)
